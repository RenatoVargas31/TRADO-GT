<!doctype html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">

<head>
    <meta charset="utf-8" />
    <title>Moda femenina</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- CSS BASE -->
    <meta th:replace="~{Common/cssBase :: css_Base}">
    <!-- End CSS BASE -->

    <!-- ION Slider -->
    <link th:href="@{../libs/ion-rangeslider/css/ion.rangeSlider.min.css}" rel="stylesheet" type="text/css"/>

</head>

<body data-sidebar="dark">

<!-- <body data-layout="horizontal" data-topbar="dark"> -->

<!-- Begin page -->
<div id="layout-wrapper">

    <!-- ========== NavBar Start ========== -->
    <header th:replace="~{Usuario/fragments/navbar :: nav_bar}"></header>
    <!-- Navbar End -->
    <!-- ========== Left Sidebar Start ========== -->
    <div th:replace="~{Usuario/fragments/sidebar :: side_bar}"></div>
    <!-- Left Sidebar End -->
    <!-- ============================================================== -->
    <!-- Start right Content here -->
    <!-- ============================================================== -->
    <div class="main-content">
        <div class="page-content">
            <div class="container-fluid">

                <!-- start page title -->
                <div class="row">
                    <div class="col-12">
                        <div class="page-title-box d-sm-flex align-items-center justify-content-between">
                            <h4 class="mb-sm-0">Moda femenina</h4>

                            <div class="page-title-right">
                                <ol class="breadcrumb m-0">

                                    <li class="breadcrumb-item active">Tienda</li>
                                    <li class="breadcrumb-item "><a href="javascript: void(0);">Moda femenina</a></li>
                                </ol>
                            </div>

                        </div>
                    </div>
                </div>
                <!-- end page title -->


                <!-- Subcategorías -->
                <div class="row">
                    <div class="card" style="height:130px">
                        <div class="card-body">
                            <div class="container">
                                <!-- Subcategorias -->
                                <div class="row flex-nowrap overflow-auto justify-content-start justify-content-md-center" style="gap: 10px;">
                                    <!-- Blusas -->
                                    <div class="col-6 col-sm-4 col-md-3 col-lg-2 text-center flex-shrink-0">
                                        <a th:href="@{/usuario/categoriaMujerFilter?categoria=1}">
                                            <img class="rounded-circle avatar-md img-fluid" alt="Blusas" th:src="@{../images/modaFemenina/blusa.jpeg}"
                                                 style="transition: transform 0.3s ease, box-shadow 0.3s ease; cursor: pointer; display: inline-block; transform-origin: center;"
                                                 onmouseover="this.style.transform='scale(1.1)'; this.style.boxShadow='0 4px 8px rgba(0, 0, 0, 0.2)';"
                                                 onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='none';">
                                        </a>
                                        <div class="mt-2">
                                            <p>Blusas</p>
                                        </div>
                                    </div>
                                    <div class="col-6 col-sm-4 col-md-3 col-lg-2 text-center flex-shrink-0">
                                        <a th:href="@{/usuario/categoriaMujerFilter?categoria=2}">
                                            <img class="rounded-circle avatar-md img-fluid" alt="Short Mujer" th:src="@{../images/modaFemenina/short.jpeg}"
                                                 style="transition: transform 0.3s ease, box-shadow 0.3s ease; cursor: pointer; display: inline-block; transform-origin: center;"
                                                 onmouseover="this.style.transform='scale(1.1)'; this.style.boxShadow='0 4px 8px rgba(0, 0, 0, 0.2)';"
                                                 onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='none';">
                                        </a>
                                        <div class="mt-2">
                                            <p>Shorts</p>
                                        </div>
                                    </div>
                                    <div class="col-6 col-sm-4 col-md-3 col-lg-2 text-center flex-shrink-0">
                                        <a th:href="@{/usuario/categoriaMujerFilter?categoria=3}">
                                            <img class="rounded-circle avatar-md img-fluid" alt="Polera Mujer" th:src="@{../images/modaFemenina/polera.jpg}"
                                                 style="transition: transform 0.3s ease, box-shadow 0.3s ease; cursor: pointer; display: inline-block; transform-origin: center;"
                                                 onmouseover="this.style.transform='scale(1.1)'; this.style.boxShadow='0 4px 8px rgba(0, 0, 0, 0.2)';"
                                                 onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='none';">
                                        </a>
                                        <div class="mt-2">
                                            <p>Poleras</p>
                                        </div>
                                    </div>
                                    <div class="col-6 col-sm-4 col-md-3 col-lg-2 text-center flex-shrink-0">
                                        <a th:href="@{/usuario/categoriaMujerFilter?categoria=4}">
                                            <img class="rounded-circle avatar-md img-fluid" alt="Pantalones Mujer" th:src="@{../images/modaFemenina/pantalon.jpg}"
                                                 style="transition: transform 0.3s ease, box-shadow 0.3s ease; cursor: pointer; display: inline-block; transform-origin: center;"
                                                 onmouseover="this.style.transform='scale(1.1)'; this.style.boxShadow='0 4px 8px rgba(0, 0, 0, 0.2)';"
                                                 onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='none';">
                                        </a>
                                        <div class="mt-2">
                                            <p>Pantalones</p>
                                        </div>
                                    </div>
                                    <div class="col-6 col-sm-4 col-md-3 col-lg-2 text-center flex-shrink-0">
                                        <a th:href="@{/usuario/categoriaMujerFilter?categoria=5}">
                                            <img class="rounded-circle avatar-md img-fluid" alt="Vestidos" th:src="@{../images/modaFemenina/vestido.jpeg}"
                                                 style="transition: transform 0.3s ease, box-shadow 0.3s ease; cursor: pointer; display: inline-block; transform-origin: center;"
                                                 onmouseover="this.style.transform='scale(1.1)'; this.style.boxShadow='0 4px 8px rgba(0, 0, 0, 0.2)';"
                                                 onmouseout="this.style.transform='scale(1)'; this.style.boxShadow='none';">
                                        </a>
                                        <div class="mt-2">
                                            <p>Vestidos</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Contenido -->
                <div class="row">
                    <!-- Filtros -->
                    <div class="col-lg-3">
                        <div class="row mb-3">
                            <div class="col">
                                <div class="card" style="max-height: 650px; overflow-y: auto;">
                                    <div class="card-header bg-transparent border-bottom">
                                        <h5 class="mb-0 fw-bolder ">Filtros</h5>
                                    </div>
                                    <!--Inicio de filtro-->
                                    <div class="custom-accordion">
                                        <form action="/usuario/categoriaMujerFilter" method="GET" id="filterForm">
                                            <div class="card-body border-top">
                                                <div>
                                                    <h5 class="font-size-14 mb-0">
                                                        <a href="#collapseExample1" class="text-reset d-block" data-bs-toggle="collapse">Categorías <i class="mdi mdi-plus float-end accor-plus-icon"></i></a>
                                                    </h5>
                                                    <div class="collapse" id="collapseExample1">
                                                        <div class="mt-4">
                                                            <div th:each="categoria : ${categoriasList}" class="form-check mt-2">
                                                                <input type="checkbox"
                                                                       th:id="'categoria' + ${categoria.id}"
                                                                       th:name="'categoria'"
                                                                       th:value="${categoria.id}"
                                                                       class="form-check-input"
                                                                       th:checked="${param.categoria != null && param.categoria.contains(categoria.id.toString())}" />


                                                                <label class="form-check-label"
                                                                       th:for="'categoria' + ${categoria.id}"
                                                                       th:text="${categoria.nombre}">Categoria</label>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>


                                            <div class="card-body border-top">
                                                <div>
                                                    <h5 class="font-size-14 mb-0">
                                                        <a href="#collapseExample5" class="text-reset d-block" data-bs-toggle="collapse" aria-expanded="false" aria-controls="collapseExample5">
                                                            Talla <i class="mdi mdi-plus float-end accor-plus-icon"></i>
                                                        </a>
                                                    </h5>
                                                    <div class="collapse" id="collapseExample5">
                                                        <div class="mt-4">
                                                            <div th:each="talla, iterStat : ${tallasList}" class="form-check mt-2">
                                                                <input type="checkbox"
                                                                       th:id="'talla' + ${iterStat}"
                                                                       name="talla"
                                                                       class="form-check-input"
                                                                       th:value="${talla.toLowerCase()}"
                                                                       th:checked="${param.talla != null && param.talla.contains(talla.toLowerCase())}"/>
                                                                <label class="form-check-label" th:for="'talla' + ${iterStat}" th:text="${talla}"></label>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-body border-top">
                                                <div>
                                                    <h5 class="font-size-14 mb-0">
                                                        <a href="#collapseExample7" class="text-reset d-block" data-bs-toggle="collapse" aria-expanded="false" aria-controls="collapseExample5">
                                                            Marca <i class="mdi mdi-plus float-end accor-plus-icon"></i>
                                                        </a>
                                                    </h5>
                                                    <div class="collapse" id="collapseExample7">
                                                        <div class="mt-4">
                                                            <div th:each="marca, iterStat : ${marcaList}" class="form-check mt-2">
                                                                <input type="checkbox"
                                                                       th:id="'marca' + ${iterStat}"
                                                                       name="marca"
                                                                       class="form-check-input"
                                                                       th:value="${marca.toLowerCase()}"
                                                                       th:checked="${param.marca != null && param.marca.contains(marca.toLowerCase())}"/>
                                                                <label class="form-check-label" th:for="'marca' + ${iterStat}" th:text="${marca}"></label>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="card-body border-top">
                                                <div>
                                                    <h5 class="font-size-14 mb-0">
                                                        <a href="#collapseExample6" class="text-reset d-block" data-bs-toggle="collapse" aria-expanded="false" aria-controls="collapseExample5">
                                                            Color <i class="mdi mdi-plus float-end accor-plus-icon"></i>
                                                        </a>
                                                    </h5>
                                                    <div class="collapse" id="collapseExample6">
                                                        <div class="mt-4">
                                                            <div th:each="color, iterStat : ${coloresList}" class="form-check mt-2">
                                                                <input type="checkbox"
                                                                       th:id="'color' + ${iterStat}"
                                                                       name="color"
                                                                       class="form-check-input"
                                                                       th:value="${color.toLowerCase()}"
                                                                       th:checked="${param.color != null && param.color.contains(color.toLowerCase())}" />
                                                                <label class="form-check-label" th:for="'color' + ${iterStat}" th:text="${color}"></label>
                                                            </div>

                                                        </div>
                                                    </div>
                                                </div>
                                            </div>


                                            <div class="card-body border-top">
                                                <div>
                                                    <h5 class="font-size-14 mb-0">
                                                        <a href="#collapseExample3" class="text-reset d-block" data-bs-toggle="collapse">Precio <i class="mdi mdi-plus float-end accor-plus-icon"></i></a>
                                                    </h5>
                                                    <div class="collapse" id="collapseExample3">
                                                        <div class="mt-4">
                                                            <div class="form-group">
                                                                <label for="precioMin" class="form-label">Precio Mínimo</label>
                                                                <input type="number" id="precioMin" name="precioMin" class="form-control" placeholder="Ingrese precio mínimo" min="0">
                                                            </div>
                                                            <hr class="opacity-0">
                                                            <div class="form-group">
                                                                <label for="precioMax" class="form-label">Precio Máximo</label>
                                                                <input type="number" id="precioMax" name="precioMax" class="form-control" placeholder="Ingrese precio máximo" min="0">
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="text-center">
                                                <a href="/usuario/categoriaMujerFilter" class="btn btn-secondary mt-3 me-2 btn-sm">Limpiar</a>
                                                <button type="submit" class="btn btn-primary mt-3 btn-sm">Filtrar</button>
                                            </div>
                                            <br>
                                        </form>
                                    </div>
                                    <!--Fin del filtro-->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Catálogo -->
                    <div class="col-lg-9">
                        <div class="card" style="max-height: 1050px; overflow-y: auto; min-height: 500px">
                            <div class="card-body">
                                <div class="container">
                                    <!-- Buscador -->
                                    <div class="row">
                                        <div class="col-md-6">
                                            <h5 class="fw-bold">Moda femenina</h5>
                                        </div>
                                        <div class="col-md-6 d-flex justify-content-end">
                                            <form class="d-flex" action="/usuario/categoriaMujerSearch" method="GET"> <!-- El action envía la búsqueda a la ruta /buscar -->
                                                <div class="search-box me-2">
                                                    <div class="position-relative">
                                                        <input type="text" name="query" class="form-control form-control-sm rounded-pill ps-5" placeholder="Buscar...">
                                                        <i class="mdi mdi-magnify search-icon position-absolute top-50 start-0 translate-middle-y ms-3"></i>
                                                    </div>
                                                </div>

                                                <div class="form-inline me-2">
                                                    <div class="d-flex flex-column flex-md-row align-items-start align-items-md-center">
                                                        <button type="submit" class="btn btn-primary waves-effect waves-light btn-sm mb-2 mb-md-0 me-md-2">Buscar</button>
                                                        <a href="/usuario/categoriaMujerFilter" class="btn btn-secondary btn-sm mb-2 mb-md-0">Limpiar</a>
                                                    </div>
                                                </div>

                                            </form>
                                        </div>
                                    </div>
                                    <hr>
                                    <!-- Cards -->
                                    <div class="row g-0">
                                        <span th:if="${sizeList > 0 and currentPage <= partes}">
                                     <strong th:text="'Resultados: ' + ${((currentPage - 1) * 12 + 1)} + ' - ' + ${currentPage * 12 > sizeList ? sizeList : currentPage * 12} + ' de ' + ${sizeList} + ' productos'"></strong>
                                        </span>
                                        <div th:if="${productList == null or #lists.isEmpty(productList)}" class="alert alert-warning text-center mt-2">
                                            No hay productos disponibles
                                        </div>
                                        <div th:each="product, iterStat : ${productList}" class="col-xl-3 col-sm-4 mt-2" >
                                            <div class="card product-box"  style="max-height: 340px; height: 340px">

                                                <a th:href="@{'/usuario/productoDetalles?id=' + ${product.id} }" class="text-decoration-none">
                                                    <div class="product-img">
                                                        <div class="product-ribbon badge bg-warning">
                                                            <!-- Mostrar el código de producto -->
                                                            <span th:text="${product.codigo}"></span>
                                                        </div>
                                                    </div>
                                                    <div th:if="${product.id >= 1}">
                                                        <img th:src="@{'/usuario/productoFoto/' + ${product.id}}"
                                                             alt="img-${product.id}"
                                                             class="img-fluid mx-auto d-block"
                                                             style="width: 250px; max-height: 160px; object-fit: cover;height: 160px;"
                                                             onerror="this.onerror=null; this.src='../images/error.jpg';"
                                                        >
                                                    </div>
                                                    <div class="text-center mt-3">
                                                        <p class="font-size-12 mb-1 text-primary">
                                                            <span th:text="${product.subcategoriaIdsubcategoria.nombre}">Categoría, Subcategoría</span>
                                                        </p>
                                                        <h5 class="font-size-15">
                                                            <a th:text="${product.nombre}" class="text-reset">Product Name</a>
                                                        </h5>
                                                        <!-- Banner del corazón (like) en la esquina superior derecha
                                                        <div class="product-like" th:if="${product.isFavorite == '1'}">
                                                            <div class="product-ribbon badge" style="position: absolute; top: 10px; right: 10px; color: red">
                                                                <div class="btn btn-danger "
                                                                     style="border-radius: 50%; padding: 10px; width: 40px; height: 40px; display: flex; justify-content: center; align-items: center;">
                                                                    <i class="mdi mdi-heart-outline" style="font-size: 24px;"></i>
                                                                </div>
                                                            </div>
                                                        </div>-->


                                                        <h5 class="mt-2" style="font-size: 14px;">
                                                            S/ <span th:text="${product.precio}">100</span>
                                                            <span style="font-size: 12px; color: #888;">por unidad</span>
                                                        </h5>
                                                    </div>
                                                    <div class="provider-info d-flex align-items-center justify-content-center" style="margin-top: auto;">
                                                        <img th:src="@{/usuario/proveedorImagen/{id}(id=${product.proveedorIdproveedor.id})}"
                                                             src="/images/product/iconoProvedor.png"
                                                             onerror="this.onerror=null;this.src='/images/product/iconoProvedor.png';"
                                                             alt="Proveedor Icono" class="rounded-circle me-2" style="width: 25px; height: 25px;">
                                                        <span th:text="${product.proveedorIdproveedor.tienda}" class="provider-name small">Nombre del proveedor</span>
                                                    </div>
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="card-footer">
                                <!-- Paginación -->
                                <div class="row mt-4">
                                    <div class="col-sm-6">
                                        <div>
                                            <p class="mb-sm-0 mt-2">
                                                Página
                                                <span class="fw-bold"
                                                      th:text="${currentPage > partes ? 1 : currentPage}"></span>
                                                de
                                                <span class="fw-bold" th:text="${partes}"></span>
                                            </p>
                                        </div>
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="float-sm-end">
                                            <ul class="pagination pagination-rounded mb-sm-0">
                                                <!-- Botón para ir a la página anterior -->
                                                <li class="page-item" th:if="${currentPage > 1}" th:classappend="${currentPage == 1} ? 'disabled'">
                                                    <a class="page-link"
                                                       th:href="@{|?${query != null ? 'query=' + query + '&' : ''}${categoria != null ? 'categoria=' + categoria + '&' : ''}${ram != null ? 'ram=' + ram + '&' : ''}${almacenamiento != null ? 'almacenamiento=' + almacenamiento + '&' : ''}${marca != null ? 'marca=' + marca + '&' : ''}${precio != null ? 'precio=' + precio + '&' : ''}${precioMin != null ? 'precioMin=' + precioMin + '&' : ''}${precioMax != null ? 'precioMax=' + precioMax + '&' : ''}page=${currentPage - 1}|}">
                                                        <i class="mdi mdi-chevron-left"></i>
                                                    </a>
                                                </li>


                                                <!-- Números de las páginas -->
                                                <li class="page-item"
                                                    th:each="i : ${#numbers.sequence(1, partes)}"
                                                    th:classappend="${currentPage == i} ? 'active'">
                                                    <a class="page-link"
                                                       th:href="@{|?${query != null ? 'query=' + query + '&' : ''}${categoria != null ? 'categoria=' + categoria + '&' : ''}${ram != null ? 'ram=' + ram + '&' : ''}${almacenamiento != null ? 'almacenamiento=' + almacenamiento + '&' : ''}${marca != null ? 'marca=' + marca + '&' : ''}${precio != null ? 'precio=' + precio + '&' : ''}${precioMin != null ? 'precioMin=' + precioMin + '&' : ''}${precioMax != null ? 'precioMax=' + precioMax + '&' : ''}page=${i}|}">[[${i}]]</a>
                                                </li>

                                                <!-- Botón para ir a la página siguiente -->
                                                <li class="page-item" th:if="${currentPage < partes}" th:classappend="${currentPage == partes} ? 'disabled'">
                                                    <a class="page-link"
                                                       th:href="@{|?${query != null ? 'query=' + query + '&' : ''}${categoria != null ? 'categoria=' + categoria + '&' : ''}${ram != null ? 'ram=' + ram + '&' : ''}${almacenamiento != null ? 'almacenamiento=' + almacenamiento + '&' : ''}${marca != null ? 'marca=' + marca + '&' : ''}${precio != null ? 'precio=' + precio + '&' : ''}${precioMin != null ? 'precioMin=' + precioMin + '&' : ''}${precioMax != null ? 'precioMax=' + precioMax + '&' : ''}page=${currentPage + 1}|}">
                                                        <i class="mdi mdi-chevron-right"></i>
                                                    </a>
                                                </li>

                                            </ul>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div> <!-- container-fluid -->
        </div>
        <script>
            document.getElementById('filterForm').onsubmit = function(event) {
                event.preventDefault(); // Evitar el envío inmediato del formulario

                const form = this;
                const formData = new FormData(form);
                const params = new URLSearchParams();

                // Agregar solo las categorías seleccionadas
                const categorias = formData.getAll('categoria');
                categorias.forEach(categoria => {
                    params.append('categoria', categoria);
                });

                // Agregar solo los materiales seleccionados
                const tallas = formData.getAll('talla');
                tallas.forEach(talla => {
                    params.append('talla', talla);
                });
                const marcas = formData.getAll('marca');
                marcas.forEach(marca => {
                    params.append('marca', marca);
                });
                const colores = formData.getAll('color');
                colores.forEach(color => {
                    params.append('color', color);
                });

                // Agregar precio mínimo si no está vacío
                const precioMin = formData.get('precioMin').trim();
                if (precioMin) {
                    params.append('precioMin', precioMin);
                }

                // Agregar precio máximo si no está vacío
                const precioMax = formData.get('precioMax').trim();
                if (precioMax) {
                    params.append('precioMax', precioMax);
                }

                // Redirigir a la URL construida
                const queryString = params.toString();
                const actionUrl = form.action + (queryString ? '?' + queryString : '');

                // Realiza el redireccionamiento
                window.location.href = actionUrl;
            };
        </script>

        <!-- End Page-content -->
        <footer class="footer">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-sm-6">
                        <script>document.write(new Date().getFullYear())</script> © TRADO.
                    </div>
                    <div class="col-sm-6">
                        <div class="text-sm-end d-none d-sm-block">
                            Crafted with <i class="mdi mdi-heart text-danger"></i> by TelesoftGT
                        </div>
                    </div>
                </div>
            </div>
        </footer>
    </div>
    <!-- end main content-->
</div>
<!-- END layout-wrapper -->


<!-- JAVASCRIPT BASE-->
<span th:replace="~{Common/jsBase :: js_Base}"></span>

<!--JAVASCRIPT NOTIFICACIONES-->
<span th:replace="~{Usuario/fragments/notificaciones-scripts :: js_Notificaciones}"></span>
<!-- End JAVASCRIPT NOTIFICACIONES-->

<!-- Ion Range Slider-->
<script th:src="@{../libs/ion-rangeslider/js/ion.rangeSlider.min.js}"></script>

<!-- init js -->
<script th:src="@{../js/pages/product-filter-range.init.js}"></script>
<!-- End JAVASCRIPT BASE-->
</body>

</html>